{% extends "base.html" %}

{% block title %}{{ t('admin.review_moderation') }} - SDU SuperApp{% endblock %}

{% block content %}
<div class="container">
    <div class="page-header">
        <h1><i class="fas fa-comments"></i> {{ t('admin.review_moderation') }}</h1>
    </div>

    <div class="admin-nav">
        <a href="{{ url_for('admin.dashboard') }}" class="admin-nav-link">
            <i class="fas fa-tachometer-alt"></i> {{ t('admin.dashboard') }}
        </a>
        <a href="{{ url_for('admin.reviews') }}" class="admin-nav-link active">
            <i class="fas fa-comments"></i> {{ t('admin.reviews') }}
        </a>
        <a href="{{ url_for('admin.teachers') }}" class="admin-nav-link">
            <i class="fas fa-chalkboard-teacher"></i> {{ t('admin.teachers') }}
        </a>
        <a href="{{ url_for('admin.news') }}" class="admin-nav-link">
            <i class="fas fa-newspaper"></i> {{ t('admin.news') }}
        </a>
        <a href="{{ url_for('admin.subscribers') }}" class="admin-nav-link">
            <i class="fas fa-users"></i> {{ t('admin.subscribers') }}
        </a>
        <a href="{{ url_for('admin.orders') }}" class="admin-nav-link">
            <i class="fas fa-shopping-bag"></i> {{ t('admin.orders') }}
        </a>
        <a href="{{ url_for('admin.products') }}" class="admin-nav-link">
            <i class="fas fa-box"></i> {{ t('admin.products') }}
        </a>
        <a href="{{ url_for('admin.logout') }}" class="admin-nav-link logout-btn">
            <i class="fas fa-sign-out-alt"></i> {{ t('admin.logout') }}
        </a>
    </div>

    {% if reviews %}
    <div class="reviews-moderation">
        {% for review in reviews %}
        <div class="moderation-card">
            <div class="moderation-header">
                <span class="review-author">{{ review.author_name }}</span>
                <div class="review-rating">
                    {% for i in range(5) %}
                    {% if i < review.rating %} <i class="fas fa-star"></i>
                        {% else %}
                        <i class="far fa-star"></i>
                        {% endif %}
                        {% endfor %}
                </div>
                <span class="review-date">{{ review.created_at[:10] }}</span>
            </div>
            <p class="review-comment">{{ review.comment }}</p>
            <div class="moderation-footer">
                <span class="teacher-link">
                    <i class="fas fa-chalkboard-teacher"></i>
                    {% if teachers.get(review.teacher_id) %}
                    <a href="{{ url_for('teachers.teacher_detail', teacher_id=review.teacher_id) }}" target="_blank">
                        {{ teachers[review.teacher_id].full_name_en }}
                    </a>
                    {% else %}
                    {{ t('admin.teacher_not_found') }}
                    {% endif %}
                </span>
                <div class="moderation-actions">
                    <form action="{{ url_for('admin.approve_review', review_id=review.id) }}" method="POST"
                        style="display: inline;">
                        <button class="btn btn-success">
                            <i class="fas fa-check"></i> {{ t('admin.approve') }}
                        </button>
                    </form>

                    <form action="{{ url_for('admin.delete_review', review_id=review.id) }}" method="POST"
                        style="display: inline;" data-confirm="{{ t('admin.delete_review_confirm') }}"
                        onsubmit="return confirm(this.getAttribute('data-confirm'));">
                        <button class="btn btn-danger">
                            <i class="fas fa-trash"></i> {{ t('admin.delete') }}
                        </button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="empty-state">
        <i class="fas fa-check-circle"></i>
        <h3>{{ t('admin.all_checked') }}</h3>
        <p>{{ t('admin.no_reviews_pending') }}</p>
    </div>
    {% endif %}
</div>
{% endblock %}